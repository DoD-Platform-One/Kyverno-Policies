# Test 1: Containers will have an additional environmental variable added
apiVersion: v1
kind: Pod
metadata:
  name: cve-add-lo4j2-mitigation-1
  annotations:
    kyverno-policies-bbtest/type: mutate
    kyverno-policies-bbtest/expected: mutate
    kyverno-policies-bbtest/key: spec.containers[0].env[0].name
    kyverno-policies-bbtest/value: LOG4J_FORMAT_MSG_NO_LOOKUPS
spec:
  containers:
  - name: c1
    image: registry1.dso.mil/ironbank/redhat/ubi/ubi8-minimal:8.5
    args:
    - "sleep"
    - "infinity"
---
# Test 2: Init containers will have an additional environmental variable added
apiVersion: v1
kind: Pod
metadata:
  name: cve-add-lo4j2-mitigation-2
  annotations:
    kyverno-policies-bbtest/type: mutate
    kyverno-policies-bbtest/expected: mutate
    kyverno-policies-bbtest/key: spec.initContainers[0].env[0].name
    kyverno-policies-bbtest/value: LOG4J_FORMAT_MSG_NO_LOOKUPS
spec:
  containers:
  - name: c1
    image: registry1.dso.mil/ironbank/redhat/ubi/ubi8-minimal:8.5
    args:
    - "sleep"
    - "infinity"
  initContainers:
  - name: i1
    image: registry1.dso.mil/ironbank/redhat/ubi/ubi8-minimal:8.5