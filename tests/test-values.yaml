bbtests:
  enabled: true
validationFailureAction: audit
waitforready:
  imagePullSecrets:
  - name: private-registry
policies:
  clone-configs:
    enabled: true
    parameters:
      clone:
      - name: clone-configs-1
        kind: ConfigMap
        namespace: kyverno-policies
      - name: clone-configs-2
        kind: Secret
        namespace: kyverno-policies
  disallow-annotations:
    enabled: true
    parameters:
      disallow:
        - 'kyverno-policies-bbtest/test: disallowed'
        - kyverno-policies-bbtest/disallowed
  disallow-default-namespace:
    enabled: true
  disallow-deprecated-apis:
    enabled: true
  disallow-host-namespaces:
    enabled: true
  disallow-host-path:
    enabled: true
  disallow-image-tags:
    enabled: true
    parameters:
      disallow:
        - disallowed
        - latest
  disallow-istio-injection-bypass:
    enabled: true
  disallow-labels:
    enabled: true
    parameters:
      disallow:
        - 'kyverno-policies-bbtest/test: disallowed'
        - kyverno-policies-bbtest/disallowed
  disallow-nodeport-services:
    enabled: true
  disallow-pod-exec:
    enabled: false
  disallow-privilege-escalation:
    enabled: true
  disallow-privileged-containers:
    enabled: true
  disallow-rbac-on-default-serviceaccounts:
    enabled: true
  disallow-subpath-volumes:
    enabled: true
  disallow-tolerations:
    enabled: true
    parameters:
      disallow:
        - effect: NoSchedule
          key: notallowed
          value: 'false'
        - effect: '*NoSchedule'
          key: disa??owed
          value: 'true'
  require-annotations:
    enabled: true
    parameters:
      require:
        - 'kyverno-policies-bbtest/test: required'
        - kyverno-policies-bbtest/required
  require-cpu-limit:
    enabled: true
    parameters:
      require:
        - <1000m
  require-drop-all-capabilities:
    enabled: true
  require-image-signature:
    enabled: false
    parameters:
      require:
        - image: ghcr.io/kyverno/test-verify-image:*
          key: |-
            -----BEGIN PUBLIC KEY-----
            MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8nXRh950IZbRj8Ra/N9sbqOPZrfM
            5/KAQN0/KjHcorm/J5yctVd7iEcnessRQjU917hmKO6JWVGHpDguIyakZA==
            -----END PUBLIC KEY-----
  require-istio-on-namespaces:
    enabled: true
  require-labels:
    enabled: true
    parameters:
      require:
        - 'kyverno-policies-bbtest/test: required'
        - kyverno-policies-bbtest/required
  require-memory-limit:
    enabled: true
    parameters:
      require:
        - <1Gi
  require-non-root-group:
    enabled: true
  require-non-root-user:
    enabled: true
  require-probes:
    enabled: true
  require-requests-equal-limits:
    enabled: true
  require-ro-host-path:
    enabled: true
  require-ro-rootfs:
    enabled: true
  restrict-apparmor:
    enabled: true
  restrict-capabilities:
    enabled: true
    parameters:
      allow:
        - allowed
  restrict-external-ips:
    enabled: true
    parameters:
      allow:
        - 192.168.1.1
        - 192.168.0.1
  restrict-external-names:
    enabled: true
    parameters:
      allow:
        - dso.mil
        - allowed
  restrict-group-id:
    enabled: true
    parameters:
      allow:
        - '1000'
        - '>=2000 & <3000'
        - '>=4000'
  restrict-host-path:
    enabled: true
    parameters:
      allow:
        - /proc/urandom
        - /tmp/allowed
  restrict-host-ports:
    enabled: true
    parameters:
      allow:
        - '63999'
        - '>= 64000 & < 65000'
        - '> 65000'
  restrict-image-registries:
    enabled: true
    parameters:
      allow:
        - allowed
        - registry1.dso.mil/ironbank/redhat/ubi/ubi8-minimal
  restrict-proc-mount:
    enabled: true
  restrict-seccomp:
    enabled: true
    parameters:
      disallow:
        - allowed
        - RuntimeDefault
  restrict-selinux-type:
    enabled: true
  restrict-sysctls:
    enabled: true
    parametes:
      allow:
        - kernel.shm_rmid_forced
        - net.ipv4.ip_local_port_range
  restrict-user-id:
    enabled: true
    parameters:
      allow:
        - '1000'
        - '>=2000 & <3000'
        - '>=4000'
  restrict-volume-types:
    enabled: true
    parameters:
      allow:
        - emptyDir
        - projected
  update-image-pull-policy:
    enabled: true
    parameters:
      update:
        - to: Always
  update-image-registry:
    enabled: true
    parameters:
      update:
        - from: replace.image.registry
          to: registry1.dso.mil
  update-token-automount:
    enabled: true